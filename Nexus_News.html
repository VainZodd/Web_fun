<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEXUS // GLOBAL NEWS GRID</title>
    
    <!-- External Assets: Google Fonts & Material Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet" />

    <!-- GSAP for High-End Animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <style>
        /* --- CORE VARIABLES & THEME --- */
        :root {
            --bg-deep: #050505;
            --bg-dark: #0a0a0a;
            --bg-panel: rgba(20, 20, 20, 0.6);
            
            --primary: #8A2BE2; /* Electric Violet */
            --accent: #BC13FE; /* Neon Purple */
            --highlight: #E0B0FF;
            --alert: #FF003C;
            --success: #00F0FF;
            
            --text-main: #FFFFFF;
            --text-muted: #A0A0A0;
            
            --glass-border: 1px solid rgba(255, 255, 255, 0.1);
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-blur: blur(16px);
            
            --shadow-neon: 0 0 10px rgba(138, 43, 226, 0.5), 0 0 20px rgba(138, 43, 226, 0.3);
            --shadow-alert: 0 0 15px rgba(255, 0, 60, 0.6);
            
            --font-head: 'Orbitron', sans-serif;
            --font-body: 'Rajdhani', sans-serif;
            
            --ease-tech: cubic-bezier(0.23, 1, 0.32, 1);
        }

        /* --- RESET & BASE --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            margin: 0; padding: 0;
            background-color: var(--bg-deep);
            color: var(--text-main);
            font-family: var(--font-body);
            overflow-x: hidden;
            /* Advanced Grid Background */
            background-image: 
                linear-gradient(rgba(138, 43, 226, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(138, 43, 226, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
            min-height: 100vh;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-deep); }
        ::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 3px; }

        /* --- UTILITY CLASSES --- */
        .hidden { display: none !important; opacity: 0; }
        .flex-center { display: flex; justify-content: center; align-items: center; }
        .text-neon { text-shadow: 0 0 8px var(--primary); color: var(--highlight); }
        .text-alert { text-shadow: 0 0 8px var(--alert); color: var(--alert); }
        
        /* High-End Glassmorphism */
        .glass-panel {
            background: var(--glass-bg);
            backdrop-filter: var(--glass-blur);
            -webkit-backdrop-filter: var(--glass-blur);
            border: var(--glass-border);
            border-top: 1px solid rgba(255,255,255,0.15);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        /* Animations */
        @keyframes fadeInView {
            from { opacity: 0; transform: translateY(20px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        @keyframes pulseGlow {
            0% { box-shadow: 0 0 5px var(--primary); }
            50% { box-shadow: 0 0 20px var(--accent); }
            100% { box-shadow: 0 0 5px var(--primary); }
        }
        @keyframes scanline {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100%); }
        }

        /* --- APP CONTAINER --- */
        #app {
            max-width: 1200px;
            margin: 0 auto;
            padding-bottom: 90px; /* Space for nav */
            position: relative;
        }

        /* --- HEADER --- */
        .top-bar {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            position: sticky;
            top: 0;
            z-index: 50;
            background: linear-gradient(to bottom, #050505 0%, rgba(5,5,5,0.8) 80%, transparent 100%);
            backdrop-filter: blur(5px);
        }
        .brand { font-family: var(--font-head); font-weight: 900; letter-spacing: 2px; font-size: 1.5rem; }
        .brand span { color: var(--primary); }
        
        /* --- NAVIGATION (Bottom Dock) --- */
        .nav-dock {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 600px;
            height: 70px;
            background: rgba(10, 10, 10, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 100;
            box-shadow: 0 10px 40px rgba(0,0,0,0.8);
            overflow: hidden;
        }
        /* Neon Line on Top of Nav */
        .nav-dock::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 1px;
            background: linear-gradient(90deg, transparent, var(--primary), transparent);
        }
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            background: none;
            border: none;
            cursor: pointer;
            width: 100%;
            height: 100%;
            transition: all 0.3s var(--ease-tech);
            position: relative;
        }
        .nav-item .material-symbols-outlined { font-size: 24px; margin-bottom: 4px; transition: 0.3s; }
        .nav-item span { font-size: 10px; font-weight: 600; letter-spacing: 1px; text-transform: uppercase; }
        
        .nav-item.active { color: var(--text-main); }
        .nav-item.active .material-symbols-outlined { 
            color: var(--accent); 
            text-shadow: 0 0 10px var(--primary);
            transform: translateY(-2px);
        }
        /* Active Indicator Dot */
        .nav-item.active::after {
            content: ''; position: absolute; bottom: 8px; width: 4px; height: 4px;
            background: var(--accent); border-radius: 50%; box-shadow: 0 0 8px var(--accent);
        }

        /* --- VIEWS STRUCTURE --- */
        .view-section {
            padding: 0 20px;
            animation: fadeInView 0.6s var(--ease-tech) forwards;
        }

        /* --- DASHBOARD VIEW --- */
        .world-map-container {
            position: relative;
            height: 280px;
            border-radius: 16px;
            overflow: hidden;
            margin-bottom: 30px;
            border: 1px solid rgba(138, 43, 226, 0.3);
            background: radial-gradient(circle at center, #1a0b2e 0%, #050505 100%);
            box-shadow: inset 0 0 50px rgba(0,0,0,0.8);
        }
        .map-bg {
            width: 100%; height: 100%;
            background-image: url('https://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/World_map_blank_without_borders.svg/2000px-World_map_blank_without_borders.svg.png');
            background-size: cover;
            background-position: center;
            filter: invert(1) hue-rotate(240deg) brightness(0.6) contrast(1.2) opacity(0.5);
            mix-blend-mode: screen;
        }
        .hotspot {
            position: absolute;
            width: 8px; height: 8px;
            background: var(--accent);
            border-radius: 50%;
            box-shadow: 0 0 10px var(--accent);
            cursor: pointer;
        }
        .hotspot::after {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            border: 1px solid var(--accent); border-radius: 50%;
            animation: ripple 2s infinite ease-out;
        }
        @keyframes ripple { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(3); opacity: 0; } }

        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .news-card {
            border-radius: 12px;
            overflow: hidden;
            transition: border-color 0.3s;
            cursor: pointer;
            position: relative;
        }
        .news-card:hover {
            box-shadow: var(--shadow-neon);
            border-color: var(--primary);
        }
        .news-thumb {
            height: 160px;
            width: 100%;
            object-fit: cover;
            filter: grayscale(40%);
            transition: 0.3s;
        }
        .news-card:hover .news-thumb { filter: grayscale(0%); }
        .card-body { padding: 15px; }
        .card-cat {
            font-size: 10px; font-weight: 700; color: var(--accent);
            border: 1px solid var(--primary); padding: 2px 6px; border-radius: 4px;
            text-transform: uppercase; margin-bottom: 8px; display: inline-block;
        }
        .card-title { font-family: var(--font-head); font-size: 1.1rem; margin-bottom: 5px; line-height: 1.4; }
        .card-meta { font-size: 0.8rem; color: var(--text-muted); display: flex; justify-content: space-between; }

        /* --- DETAIL VIEW --- */
        .detail-hero {
            height: 40vh;
            width: 100%;
            background-size: cover;
            background-position: center;
            position: relative;
            mask-image: linear-gradient(to bottom, black 60%, transparent 100%);
            margin-bottom: -80px;
        }
        .detail-content-wrapper {
            position: relative;
            z-index: 10;
            padding: 30px;
            border-radius: 24px 24px 0 0;
            margin: 0 10px;
        }
        .detail-badges { display: flex; gap: 10px; margin-bottom: 20px; }
        .glow-badge {
            background: rgba(138, 43, 226, 0.15);
            color: var(--highlight);
            border: 1px solid var(--primary);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.2);
            text-transform: uppercase;
        }
        .fab-group {
            position: absolute; top: -30px; right: 20px;
            display: flex; flex-direction: column; gap: 15px;
        }
        .fab {
            width: 50px; height: 50px;
            border-radius: 50%;
            background: #000;
            border: 1px solid var(--accent);
            color: var(--text-main);
            display: flex; justify-content: center; align-items: center;
            box-shadow: 0 0 15px rgba(188, 19, 254, 0.4);
            cursor: pointer;
            transition: 0.3s;
        }
        .fab:hover { background: var(--accent); transform: scale(1.1); }

        /* --- TIMELINE VIEW --- */
        .timeline-wrapper {
            position: relative;
            padding-left: 30px;
            border-left: 2px solid rgba(138, 43, 226, 0.3);
            margin-left: 20px;
        }
        .timeline-wrapper::after {
            content: ''; position: absolute; top: 0; bottom: 0; left: -1px; width: 2px;
            background: linear-gradient(to bottom, transparent, var(--accent), transparent);
            box-shadow: 0 0 15px var(--accent);
        }
        .timeline-node {
            position: relative;
            margin-bottom: 40px;
        }
        .node-dot {
            position: absolute; left: -39px; top: 15px;
            width: 16px; height: 16px;
            background: #050505;
            border: 2px solid var(--accent);
            border-radius: 50%;
            z-index: 2;
            transition: 0.3s;
        }
        .timeline-node:hover .node-dot {
            background: var(--accent);
            box-shadow: 0 0 15px var(--accent);
            transform: scale(1.3);
        }
        .time-label { font-family: var(--font-head); color: var(--primary); font-size: 0.9rem; margin-bottom: 5px; }

        /* --- LIVE VIEW --- */
        .video-player-frame {
            width: 100%;
            aspect-ratio: 16/9;
            background: #000;
            border-radius: 12px;
            border: 1px solid var(--glass-border);
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
            margin-bottom: 20px;
        }
        .live-indicator {
            position: absolute; top: 15px; left: 15px;
            background: rgba(255, 0, 60, 0.8);
            color: white; padding: 4px 10px; border-radius: 4px;
            font-weight: 800; font-size: 0.8rem;
            display: flex; align-items: center; gap: 6px;
            box-shadow: 0 0 10px rgba(255, 0, 60, 0.6);
        }
        .live-dot { width: 8px; height: 8px; background: white; border-radius: 50%; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0; } }
        
        .multiview-btn {
            position: absolute; bottom: 15px; right: 15px;
            background: rgba(0,0,0,0.6); border: 1px solid var(--primary);
            color: var(--primary); padding: 5px 12px;
            font-family: var(--font-head); font-size: 0.7rem; letter-spacing: 1px;
            cursor: pointer; text-transform: uppercase;
        }
        
        .chat-hud {
            height: 300px;
            border-top: 1px solid var(--glass-border);
            position: relative;
            display: flex; flex-direction: column;
        }
        .chat-feed {
            flex: 1; overflow-y: auto; padding: 15px;
            display: flex; flex-direction: column; gap: 10px;
            /* Scroll from bottom effect handled by JS flex-end or scroll */
        }
        .chat-bubble {
            background: rgba(138, 43, 226, 0.1);
            border: 1px solid rgba(138, 43, 226, 0.2);
            padding: 8px 12px;
            border-radius: 12px 12px 12px 0;
            max-width: 85%;
            font-size: 0.9rem;
            animation: slideUpFade 0.4s ease-out;
            backdrop-filter: blur(4px);
        }
        @keyframes slideUpFade { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .chat-user { color: var(--highlight); font-weight: 700; font-size: 0.8rem; display: block; margin-bottom: 2px; }

        /* News Ticker */
        .ticker-container {
            width: 100%;
            background: rgba(138, 43, 226, 0.1);
            border-bottom: 1px solid var(--primary);
            overflow: hidden;
            white-space: nowrap;
            padding: 8px 0;
            margin-bottom: 20px;
        }
        .ticker-content {
            display: inline-block;
            padding-left: 100%;
            animation: ticker 30s linear infinite;
        }
        .ticker-item {
            display: inline-block;
            padding: 0 40px;
            font-family: var(--font-head);
            font-size: 0.9rem;
            color: var(--highlight);
        }
        @keyframes ticker {
            0% { transform: translate3d(0, 0, 0); }
            100% { transform: translate3d(-100%, 0, 0); }
        }

        /* --- PROFILE VIEW --- */
        .profile-card {
            display: flex; align-items: center; gap: 20px; padding: 25px; margin-bottom: 25px;
        }
        .avatar-ring {
            width: 90px; height: 90px;
            border-radius: 50%;
            padding: 4px;
            border: 2px dashed var(--accent);
            position: relative;
        }
        .avatar-ring img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; }
        .status-dot {
            position: absolute; bottom: 0; right: 0; width: 16px; height: 16px;
            background: var(--success); border-radius: 50%;
            border: 3px solid var(--bg-deep);
            box-shadow: 0 0 10px var(--success);
        }
        
        /* Tech Toggles */
        .region-control {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px; margin-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .tech-switch {
            position: relative; width: 50px; height: 26px;
            -webkit-appearance: none; background: #222;
            border-radius: 20px; outline: none; cursor: pointer;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.5);
            transition: 0.4s; border: 1px solid #444;
        }
        .tech-switch:checked { background: var(--primary); border-color: var(--accent); box-shadow: 0 0 10px var(--primary); }
        .tech-switch::before {
            content: ''; position: absolute; width: 20px; height: 20px;
            border-radius: 50%; top: 2px; left: 2px;
            background: #fff; transition: 0.4s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
        }
        .tech-switch:checked::before { transform: translateX(24px); }

        /* Stat Bars */
        .stat-bar-container { margin-bottom: 15px; }
        .stat-label { font-size: 0.8rem; color: var(--text-muted); display: flex; justify-content: space-between; margin-bottom: 5px; }
        .bar-track { width: 100%; height: 6px; background: #222; border-radius: 3px; overflow: hidden; }
        .bar-fill { height: 100%; background: linear-gradient(90deg, var(--primary), var(--accent)); width: 0%; transition: width 1s ease-out; box-shadow: 0 0 10px var(--primary); }

        /* --- ARCHIVE VIEW --- */
        .search-container { position: relative; margin-bottom: 25px; }
        .tech-input {
            width: 100%; padding: 15px 15px 15px 45px;
            background: rgba(0,0,0,0.5); border: 1px solid var(--primary);
            border-radius: 8px; color: white; font-family: var(--font-body); font-size: 1rem;
            outline: none; transition: 0.3s;
        }
        .tech-input:focus { box-shadow: var(--shadow-neon); border-color: var(--accent); }
        .search-icon { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--primary); }

        /* --- MODAL (Filters) --- */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95);
            z-index: 200; display: flex; align-items: center; justify-content: center;
            backdrop-filter: blur(10px);
        }
        .filter-content {
            width: 90%; max-width: 450px;
            background: #0a0a0a; border: 1px solid var(--primary);
            border-radius: 16px; padding: 30px;
            box-shadow: 0 0 50px rgba(138, 43, 226, 0.2);
            position: relative;
        }
        .modal-header {
            font-family: var(--font-head); font-size: 1.5rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 15px; margin-bottom: 20px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .tech-slider {
            -webkit-appearance: none; width: 100%; height: 4px;
            background: #333; outline: none; margin: 20px 0;
        }
        .tech-slider::-webkit-slider-thumb {
            -webkit-appearance: none; width: 20px; height: 20px;
            background: var(--accent); border-radius: 50%; cursor: pointer;
            box-shadow: 0 0 10px var(--accent); border: 2px solid #fff;
        }
        .btn-tech {
            width: 100%; padding: 15px; background: var(--primary); color: white;
            font-family: var(--font-head); font-weight: 700; border: none;
            border-radius: 8px; cursor: pointer; letter-spacing: 1px;
            transition: 0.3s; margin-top: 10px;
            text-transform: uppercase;
        }
        .btn-tech:hover { background: var(--accent); box-shadow: var(--shadow-neon); }

        /* --- BREAKING NEWS POPUP --- */
        .breaking-popup {
            position: fixed; top: 20%; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 400px;
            background: rgba(10, 0, 5, 0.95);
            border: 2px solid var(--alert);
            border-radius: 12px; padding: 25px; text-align: center;
            z-index: 300; box-shadow: var(--shadow-alert), 0 0 100px rgba(255,0,0,0.2);
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        @keyframes shake { 10%, 90% { transform: translate3d(-51%, -1px, 0); } 20%, 80% { transform: translate3d(-49%, 2px, 0); } 30%, 50%, 70% { transform: translate3d(-52%, -4px, 0); } 40%, 60% { transform: translate3d(-48%, 4px, 0); } }

        /* Glitch Effect */
        .glitch-text {
            position: relative;
            animation: glitch 2s infinite;
        }
        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }

        /* Skeleton Loading */
        .skeleton {
            background: linear-gradient(90deg, #111 25%, #222 50%, #111 75%);
            background-size: 200% 100%;
            animation: skeleton-load 1.5s infinite;
        }
        @keyframes skeleton-load {
            from { background-position: 200% 0; }
            to { background-position: -200% 0; }
        }

    </style>
</head>
<body>

<!-- APP ROOT -->
<div id="app">

    <!-- TOP HEADER -->
    <header class="top-bar">
        <div class="brand">NEXUS<span>//</span>NEWS</div>
        <button onclick="toggleFilters()" style="background:none; border:none; color:var(--primary); cursor:pointer;">
            <span class="material-symbols-outlined">tune</span>
        </button>
    </header>

    <!-- VIEW: DASHBOARD (Home) -->
    <section id="dashboard" class="view-section">
        <div class="world-map-container">
            <div class="map-bg"></div>
            <!-- Hotspots dynamically simulated -->
            <div class="hotspot" style="top: 30%; left: 25%;" onclick="loadNews(0)"></div>
            <div class="hotspot" style="top: 45%; left: 50%; animation-delay: 0.5s;" onclick="loadNews(1)"></div>
            <div class="hotspot" style="top: 60%; left: 75%; animation-delay: 1s;" onclick="loadNews(2)"></div>
            <div style="position: absolute; bottom: 15px; left: 15px; font-family: var(--font-head); font-size: 0.7rem; color: var(--text-muted); letter-spacing: 1px;">
                <span style="color:var(--success)">‚óè</span> SYSTEM ONLINE
            </div>
        </div>

        <h3 class="text-neon" style="font-family: var(--font-head); margin-bottom: 20px;">LATEST TRANSMISSIONS</h3>
        <div class="news-grid" id="news-feed">
            <!-- News injected via JS -->
        </div>
    </section>

    <!-- VIEW: DETAIL -->
    <section id="detail" class="view-section hidden">
        <div class="detail-hero" id="detail-img"></div>
        <div class="glass-panel detail-content-wrapper">
            <div class="fab-group">
                <button class="fab"><span class="material-symbols-outlined">share</span></button>
                <button class="fab"><span class="material-symbols-outlined">bookmark</span></button>
            </div>
            
            <div class="detail-badges" id="detail-tags">
                <!-- Tags injected -->
            </div>
            
            <h1 id="detail-title" style="font-family: var(--font-head); line-height: 1.2; margin-bottom: 15px;"></h1>
            <div class="card-meta" style="margin-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px;">
                <span id="detail-region" class="text-neon"></span>
                <span id="detail-date"></span>
            </div>
            
            <div id="detail-text" style="line-height: 1.8; color: #ddd; font-size: 1.05rem;"></div>
            
            <button onclick="navTo('dashboard')" class="btn-tech" style="margin-top: 30px; width: auto; padding: 10px 30px;">
                <span class="material-symbols-outlined" style="vertical-align: middle; font-size: 18px;">arrow_back</span> RETURN
            </button>
        </div>
    </section>

    <!-- VIEW: TIMELINE -->
    <section id="timeline" class="view-section hidden">
        <h2 style="font-family: var(--font-head); margin-bottom: 30px;" class="text-neon">EVENT CHRONOLOGY</h2>
        <div class="timeline-wrapper" id="timeline-container">
            <!-- Timeline items injected -->
        </div>
    </section>

    <!-- VIEW: LIVE -->
    <section id="live" class="view-section hidden">
        <div class="ticker-container">
            <div class="ticker-content" id="live-ticker">
                <!-- Ticker items -->
            </div>
        </div>

        <div class="video-player-frame">
            <video loop muted autoplay style="width: 100%; height: 100%; object-fit: cover; opacity: 0.7;">
                <!-- Dummy Video Background -->
                <source src="https://assets.mixkit.co/videos/preview/mixkit-futuristic-holographic-interface-902-large.mp4" type="video/mp4">
            </video>
            <div class="live-indicator"><div class="live-dot"></div> LIVE FEED</div>
            <button class="multiview-btn"><span class="material-symbols-outlined" style="vertical-align: middle; font-size: 14px;">grid_view</span> MULTIVIEW</button>
            
            <!-- Fake UI Overlay -->
            <div style="position: absolute; bottom: 15px; left: 15px;">
                <h4 style="margin: 0; font-family: var(--font-head);">SECTOR 7 CAM A</h4>
                <span style="font-size: 0.7rem; color: var(--success);">SIGNAL STABLE</span>
            </div>
        </div>

        <div style="display: flex; gap: 10px; margin-bottom: 20px;">
            <div class="glass-panel" style="flex:1; padding: 10px; text-align: center; border-radius: 8px;">
                <div style="font-family: var(--font-head); color: var(--accent); font-size: 1.2rem;" id="live-viewers">24.5K</div>
                <div style="font-size: 0.7rem; color: var(--text-muted);">WATCHING</div>
            </div>
            <div class="glass-panel" style="flex:1; padding: 10px; text-align: center; border-radius: 8px;">
                <div style="font-family: var(--font-head); color: var(--success); font-size: 1.2rem;">98%</div>
                <div style="font-size: 0.7rem; color: var(--text-muted);">SIGNAL</div>
            </div>
        </div>

        <div class="glass-panel chat-hud" style="border-radius: 12px;">
            <div class="chat-feed" id="chat-container">
                <!-- Chat messages -->
            </div>
            <div style="padding: 10px; background: rgba(0,0,0,0.3); display: flex; align-items: center;">
                <input type="text" placeholder="ENCRYPTED MESSAGE..." style="flex: 1; background: transparent; border: none; color: white; outline: none; font-family: var(--font-body);">
                <button style="background: none; border: none; color: var(--primary); cursor: pointer;"><span class="material-symbols-outlined">send</span></button>
            </div>
        </div>
    </section>

    <!-- VIEW: PROFILE -->
    <section id="profile" class="view-section hidden">
        <div class="glass-panel profile-card" style="border-radius: 16px;">
            <div class="avatar-ring">
                <img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?auto=format&fit=crop&w=150&q=80" alt="User">
                <div class="status-dot"></div>
            </div>
            <div>
                <h2 style="font-family: var(--font-head); margin: 0;">ALEX V.</h2>
                <span style="color: var(--accent); font-size: 0.8rem; letter-spacing: 1px;">ELITE ANALYST</span>
            </div>
        </div>

        <h3 style="font-family: var(--font-head); margin-bottom: 15px;">FOCUSED REGIONS</h3>
        <div class="glass-panel" style="border-radius: 12px; margin-bottom: 30px;">
            <div class="region-control">
                <span>NEO TOKYO</span>
                <input type="checkbox" class="tech-switch" checked>
            </div>
            <div class="region-control">
                <span>BERLIN PRIME</span>
                <input type="checkbox" class="tech-switch" checked>
            </div>
            <div class="region-control" style="border-bottom: none;">
                <span>LUNAR BASE</span>
                <input type="checkbox" class="tech-switch">
            </div>
        </div>

        <h3 style="font-family: var(--font-head); margin-bottom: 15px;">READING METRICS</h3>
        <div class="stat-bar-container">
            <div class="stat-label"><span>TECH</span><span>84%</span></div>
            <div class="bar-track"><div class="bar-fill" style="width: 84%"></div></div>
        </div>
        <div class="stat-bar-container">
            <div class="stat-label"><span>POLITICS</span><span>45%</span></div>
            <div class="bar-track"><div class="bar-fill" style="width: 45%; background: linear-gradient(90deg, #444, #888);"></div></div>
        </div>
    </section>

    <!-- VIEW: ARCHIVE -->
    <section id="archive" class="view-section hidden">
        <h2 style="font-family: var(--font-head); margin-bottom: 20px;">NEURAL ARCHIVE</h2>
        <div class="search-container">
            <span class="material-symbols-outlined search-icon">search</span>
            <input type="text" class="tech-input" placeholder="QUERY DATABASE...">
        </div>
        
        <div class="news-grid" id="archive-feed">
            <!-- Copied feed items for demo -->
        </div>
    </section>

    <!-- MODAL: FILTERS -->
    <div id="filter-modal" class="modal-overlay hidden">
        <div class="filter-content glass-panel">
            <div class="modal-header">
                ADVANCED FILTERS
                <button onclick="toggleFilters()" style="background:none; border:none; color:white; cursor:pointer;"><span class="material-symbols-outlined">close</span></button>
            </div>
            
            <label style="color: var(--text-muted); font-size: 0.8rem;">TIMEFRAME SCAN</label>
            <input type="range" class="tech-slider" min="0" max="100">
            
            <label style="color: var(--text-muted); font-size: 0.8rem; display:block; margin-top: 20px;">DATA TYPE</label>
            <div style="display: flex; gap: 10px; margin-top: 10px;">
                <button class="glow-badge" style="background: var(--primary); color: white;">HOLOGRAM</button>
                <button class="glow-badge" style="background: transparent;">TEXT</button>
            </div>

            <button class="btn-tech" onclick="toggleFilters()">INITIATE FILTER</button>
        </div>
    </div>

    <!-- POPUP: BREAKING NEWS -->
    <div id="breaking-popup" class="breaking-popup hidden">
        <div style="display: flex; justify-content: center; margin-bottom: 10px;">
            <span class="material-symbols-outlined glitch-text" style="font-size: 48px; color: var(--alert);">warning</span>
        </div>
        <h2 class="text-alert glitch-text" style="font-family: var(--font-head); margin: 0 0 10px 0;">SYSTEM ALERT</h2>
        <h3 style="margin: 0 0 15px 0;">GLOBAL ENERGY SPIKE DETECTED</h3>
        <p style="color: #ccc; font-size: 0.9rem; margin-bottom: 20px;">Unprecedented surge in sector 4 grid. Immediate attention required.</p>
        
        <button class="btn-tech" style="background: transparent; border: 1px solid var(--alert); color: var(--alert);" onclick="closeBreaking()">DISMISS</button>
        <button class="btn-tech" style="background: var(--alert); margin-top: 10px;" onclick="navTo('detail'); closeBreaking();">ACCESS REPORT</button>
    </div>

</div> <!-- END APP -->

<!-- NAVIGATION BOTTOM DOCK -->
<nav class="nav-dock">
    <button class="nav-item active" onclick="navTo('dashboard')" id="nav-dashboard">
        <span class="material-symbols-outlined">grid_view</span>
        <span>GRID</span>
    </button>
    <button class="nav-item" onclick="navTo('timeline')" id="nav-timeline">
        <span class="material-symbols-outlined">history</span>
        <span>TIME</span>
    </button>
    <button class="nav-item" onclick="navTo('live')" id="nav-live">
        <span class="material-symbols-outlined">stream</span>
        <span>LIVE</span>
    </button>
    <button class="nav-item" onclick="navTo('profile')" id="nav-profile">
        <span class="material-symbols-outlined">person</span>
        <span>ID</span>
    </button>
    <button class="nav-item" onclick="navTo('archive')" id="nav-archive">
        <span class="material-symbols-outlined">folder_open</span>
        <span>DATA</span>
    </button>
</nav>

<script>
    /* --- DATA STORE --- */
    let db = {
        news: [],
        timeline: [],
        chats: [
            { user: "Ghost_01", msg: "Did you see the flux?" },
            { user: "NeonRider", msg: "Signal is clean today." },
            { user: "SysAdmin", msg: "Monitoring bandwidth." }
        ]
    };

    const API_URL = 'https://ok.surf/api/v1/cors/news-feed';
    const CACHE_KEY = 'nexus_news_data';
    const CACHE_TIME_KEY = 'nexus_news_timestamp';
    const REFRESH_INTERVAL = 30 * 60 * 1000; // 30 minutes

    async function fetchNews() {
        const now = Date.now();
        const cachedTime = localStorage.getItem(CACHE_TIME_KEY);
        const cachedData = localStorage.getItem(CACHE_KEY);

        if (cachedTime && cachedData && (now - cachedTime < REFRESH_INTERVAL)) {
            console.log("Using cached news data");
            processNewsData(JSON.parse(cachedData));
            return;
        }

        console.log("Fetching fresh news...");
        try {
            const response = await fetch(API_URL);
            const data = await response.json();

            localStorage.setItem(CACHE_KEY, JSON.stringify(data));
            localStorage.setItem(CACHE_TIME_KEY, now.toString());

            processNewsData(data);
        } catch (error) {
            console.error("Failed to fetch news:", error);
            if (cachedData) {
                processNewsData(JSON.parse(cachedData));
            }
        }
    }

    function processNewsData(data) {
        let flattenedNews = [];
        let id = 0;

        const categoryMap = {
            'World': 'GLOBAL',
            'Business': 'FINANCE',
            'Technology': 'TECH',
            'Science': 'SCIENCE',
            'Health': 'BIO',
            'Entertainment': 'MEDIA',
            'Sports': 'ARENA'
        };

        for (const [cat, items] of Object.entries(data)) {
            items.forEach(item => {
                flattenedNews.push({
                    id: id++,
                    title: item.title,
                    region: item.source,
                    date: new Date().toLocaleDateString(), // API doesn't provide date, use current
                    cat: categoryMap[cat] || cat.toUpperCase(),
                    img: item.og || 'https://images.unsplash.com/photo-1451187580459-43490279c0fa?auto=format&fit=crop&w=600&q=80',
                    content: `Source: ${item.source}. Full report available via encrypted link. Accessing data stream from ${cat} sector...`,
                    link: item.link
                });
            });
        }

        // Sort by ID (arbitrary) or shuffle for variety
        db.news = flattenedNews.slice(0, 50);

        // Generate Timeline from news
        db.timeline = db.news.slice(0, 10).map((n, index) => ({
            time: `${12 - index}:00`,
            title: n.title,
            desc: `Data packet received from ${n.region}. Source verified.`
        }));

        renderNews();
        renderTimeline();
    }

    /* --- CORE FUNCTIONS --- */
    
    // Navigation Logic with GSAP (Snappy Transitions)
    function navTo(viewId) {
        const currentView = document.querySelector('.view-section:not(.hidden)');
        const targetView = document.getElementById(viewId);
        
        if (currentView === targetView) return;

        // Animate Out
        if (currentView) {
            gsap.to(currentView, {
                opacity: 0,
                y: -10,
                duration: 0.2,
                ease: "power2.in",
                onComplete: () => {
                    currentView.classList.add('hidden');
                    showTarget();
                }
            });
        } else {
            showTarget();
        }

        function showTarget() {
            targetView.classList.remove('hidden');
            gsap.fromTo(targetView,
                { opacity: 0, y: 10, scale: 0.98 },
                { opacity: 1, y: 0, scale: 1, duration: 0.3, ease: "power2.out" }
            );
        }

        // Update Dock
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        const navBtn = document.getElementById('nav-' + viewId);
        if(navBtn) {
            navBtn.classList.add('active');
            gsap.from(navBtn.querySelector('.material-symbols-outlined'), { scale: 0.5, duration: 0.2, ease: "back.out(2)" });
        }
        
        window.scrollTo({ top: 0, behavior: 'smooth' });

        // Re-init context specific features if needed
        if (viewId === 'live') initLive();
    }

    // Micro-interactions
    function initInteractions() {
        document.addEventListener('mouseover', (e) => {
            const card = e.target.closest('.news-card');
            if (card) {
                gsap.to(card, { y: -5, duration: 0.2, ease: "power2.out" });
            }
        });
        document.addEventListener('mouseout', (e) => {
            const card = e.target.closest('.news-card');
            if (card) {
                gsap.to(card, { y: 0, duration: 0.2, ease: "power2.in" });
            }
        });
    }

    // Load News to Dashboard
    function renderNews() {
        const container = document.getElementById('news-feed');
        const archive = document.getElementById('archive-feed');
        if (!container) return;
        
        let html = '';
        if (db.news.length === 0) {
            html = '<div class="skeleton" style="height: 200px; width: 100%; border-radius: 12px;"></div>'.repeat(3);
        } else {
            db.news.forEach(item => {
                html += `
                <div class="glass-panel news-card" onclick="loadDetail(${item.id})">
                    <img src="${item.img}" class="news-thumb" onerror="this.src='https://images.unsplash.com/photo-1451187580459-43490279c0fa?auto=format&fit=crop&w=600&q=80'">
                    <div class="card-body">
                        <span class="card-cat">${item.cat}</span>
                        <h4 class="card-title">${item.title}</h4>
                        <div class="card-meta">
                            <span>${item.region}</span>
                            <span>${item.date}</span>
                        </div>
                    </div>
                </div>`;
            });
        }
        
        container.innerHTML = html;
        if (archive) archive.innerHTML = html;

        // Animate entrance
        gsap.from(".news-card", {
            y: 30,
            opacity: 0,
            duration: 0.4,
            stagger: 0.05,
            ease: "power2.out"
        });
    }

    // Load Detail View
    function loadDetail(id) {
        const item = db.news.find(i => i.id === id);
        
        document.getElementById('detail-img').style.backgroundImage = `url(${item.img})`;
        document.getElementById('detail-title').innerText = item.title;
        document.getElementById('detail-region').innerText = item.region;
        document.getElementById('detail-date').innerText = item.date;
        document.getElementById('detail-text').innerText = item.content + " Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.";
        
        const tags = document.getElementById('detail-tags');
        tags.innerHTML = `<span class="glow-badge">${item.cat}</span><span class="glow-badge" style="border-color:white; color:white;">VERIFIED</span>`;
        
        navTo('detail');
    }
    
    // Wrapper for hotspot clicks
    function loadNews(index) {
        // Find news in 'GLOBAL' category for hotspots
        const globalNews = db.news.filter(n => n.cat === 'GLOBAL');
        if (globalNews.length > index) {
            loadDetail(globalNews[index].id);
        } else if (db.news.length > index) {
            loadDetail(db.news[index].id);
        }
    }

    // Render Timeline
    function renderTimeline() {
        const container = document.getElementById('timeline-container');
        if (!container) return;
        container.innerHTML = '';
        db.timeline.forEach(item => {
            container.innerHTML += `
            <div class="glass-panel timeline-node" style="padding: 15px; border-radius: 8px;">
                <div class="node-dot"></div>
                <div class="time-label">${item.time}</div>
                <h4 style="margin: 0 0 5px 0;">${item.title}</h4>
                <p style="margin:0; font-size: 0.85rem; color: #aaa;">${item.desc}</p>
            </div>`;
        });
    }

    // Filters
    function toggleFilters() {
        const modal = document.getElementById('filter-modal');
        modal.classList.toggle('hidden');
    }

    // Breaking News Logic
    function closeBreaking() {
        document.getElementById('breaking-popup').classList.add('hidden');
    }

    // Live Simulations
    let liveIntervals = [];
    function initLive() {
        // Clear previous intervals if any
        liveIntervals.forEach(clearInterval);
        liveIntervals = [];

        // Ticker
        const ticker = document.getElementById('live-ticker');
        if (ticker) {
            ticker.innerHTML = db.news.map(n => `<span class="ticker-item">${n.title} [//] ${n.region}</span>`).join('');
        }

        // Viewers
        const viewerInt = setInterval(() => {
            const el = document.getElementById('live-viewers');
            if (el) {
                let val = parseFloat(el.innerText);
                val += (Math.random() - 0.5);
                el.innerText = val.toFixed(1) + "K";
            }
        }, 1500);
        liveIntervals.push(viewerInt);

        // Chat
        const chatContainer = document.getElementById('chat-container');
        if (chatContainer) {
            chatContainer.innerHTML = '';
            // Initial load
            db.chats.forEach(c => addChat(c.user, c.msg));
        }

        // Random new msg
        const chatInt = setInterval(() => {
            const users = ["Runner", "Net_Zero", "ChromeHeart", "V_"];
            const msgs = ["System looks stable.", "Any updates?", "Who is watching?", "Signal is strong."];
            addChat(users[Math.floor(Math.random()*users.length)], msgs[Math.floor(Math.random()*msgs.length)]);
        }, 3500);
        liveIntervals.push(chatInt);

        function addChat(u, m) {
            if (!chatContainer) return;
            const div = document.createElement('div');
            div.className = 'chat-bubble';
            div.innerHTML = `<span class="chat-user">${u}:</span> ${m}`;
            chatContainer.appendChild(div);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }
    }

    // Archive Search
    function initSearch() {
        const input = document.querySelector('#archive .tech-input');
        if (!input) return;

        input.addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase();
            const filtered = db.news.filter(n =>
                n.title.toLowerCase().includes(term) ||
                n.region.toLowerCase().includes(term) ||
                n.cat.toLowerCase().includes(term)
            );

            const container = document.getElementById('archive-feed');
            let html = '';
            filtered.forEach(item => {
                html += `
                <div class="glass-panel news-card" onclick="loadDetail(${item.id})">
                    <img src="${item.img}" class="news-thumb" onerror="this.src='https://images.unsplash.com/photo-1451187580459-43490279c0fa?auto=format&fit=crop&w=600&q=80'">
                    <div class="card-body">
                        <span class="card-cat">${item.cat}</span>
                        <h4 class="card-title">${item.title}</h4>
                        <div class="card-meta">
                            <span>${item.region}</span>
                            <span>${item.date}</span>
                        </div>
                    </div>
                </div>`;
            });
            container.innerHTML = html;
        });
    }

    /* --- INITIALIZATION --- */
    window.addEventListener('DOMContentLoaded', () => {
        fetchNews();
        initLive();
        initSearch();
        initInteractions();

        // 30-minute auto-refresh check
        setInterval(() => {
            fetchNews();
        }, 60000); // Check every minute, fetchNews handles the 30min logic
        
        // Trigger Breaking News after 8s
        setTimeout(() => {
            if (db.news.length > 0) {
                const breaking = db.news[Math.floor(Math.random() * db.news.length)];
                const popup = document.getElementById('breaking-popup');
                popup.querySelector('h3').innerText = breaking.title;
                popup.querySelector('p').innerText = breaking.content;
                popup.classList.remove('hidden');
                gsap.from(popup, { scale: 0.8, opacity: 0, duration: 0.5, ease: "back.out(1.7)" });
            }
        }, 8000);
    });

</script>
</body>
</html>